"use strict";module.exports=function(req,res){var net=req.query.data;if(!net){res.status(400).end();return}try{net=JSON.parse(net)}catch(error){res.status(400).end();return}console.log(net);var s="";if(net["net-eth0-active"]==="true"){s="auto eth0\n"}else{s="#auto eth0\n"}s=s+"iface eth0 inet "+net["net-eth0-mode"]+"\n";s=s+"address "+net["net-eth0-ip"]+"\n";s=s+"netmask "+net["net-eth0-mask"]+"\n";s=s+"gateway "+net["net-eth0-gateway"]+"\n";if(net["net-route-default-gateway-dev"]==="eth0"){s=s+"post-up route add default via "+net["net-route-default-gateway"]+" dev eth0\n"}fs.writeFileSync("/etc/network/eth0",s);console.log("eth0 = \n",s);s="";if(net["net-eth1-active"]==="true"){s="auto eth1\n"}else{s="#auto eth1\n"}s=s+"iface eth1 inet "+net["net-eth1-mode"]+"\n";s=s+"address "+net["net-eth1-ip"]+"\n";s=s+"netmask "+net["net-eth1-mask"]+"\n";s=s+"gateway "+net["net-eth1-gateway"]+"\n";if(net["net-route-default-gateway-dev"]==="eth1"){s=s+"post-up route add default via "+net["net-route-default-gateway"]+" dev eth1\n"}fs.writeFileSync("/etc/network/eth1",s);console.log("eth1 = \n",s);var dns=net["net-nameserver"].split(/[ ,;]/);s="";for(var i=0;i<dns.length;i++){s=s+"nameserver "+dns[i]+"\n"}fs.writeFileSync("/etc/resolvconf/resolv.conf.d/base",s);var result={result:"OK"};res.end(JSON.stringify(result));var exec=require("child_process").exec;exec("box-net-restart")};