<!DOCTYPE html><html lang=en>{{> header}}{{> page_header}}<div id=body-container><div id=body-content>{{> nav }}<section class="page container"><div class=row><div class=span4><div class="box pattern pattern-sandstone"><div class=box-header><i class=icon-list></i><h5>设备状态</h5></div><div class="box-content box-table"><table class="table table-striped table-hover table-bordered tablesorter"><tr><td>刷新倒计时<td><span id=update-counter>0</span><tr><td>设备运行时间<td><span id=sys-uptime>未知</span><tr><td>设备当前时间<td><span id=sys-time>未知</span><tr><td>设备型号<td><span id=sys-model>CN8000</span><tr><td>设备ID<td><span id=sys-sn>未知</span><tr><td>固件版本<td><span id=sys-version>未知</span><tr><td>操作系统<td><span id=sys-os>未知</span><tr><td>串口状态<td><span id=sys-serial>未知</span><tr><td>网络状态<td><span id=sys-network>未知</span><tr><td>在线设备数<td><span id=total-online>未知</span></table></div></div></div><div class="box pattern-sandstone span11"><div class=box-header><i class=icon-table></i><h5>接警线路列表</h5></div><div class="box-content box-table"><table class="table table-striped table-hover table-bordered tablesorter"><thead><tr><th class="center span2">是否启用<th class="center span1">线号<th class="center span2">名称<th class="center span2">用户号前缀<th class="center span2">端口<th class="center span2">协议<tbody id=lines-list></table></div></div><div class=span11><div class="box pattern pattern-sandstone"><div class=box-header><i class=icon-table></i><h5>在线设备(设备上线/掉线10秒内反应到此列表) <span>&nbsp;&nbsp;&nbsp;</span></h5></div><div class="box-content box-table"><table class="table table-striped table-hover table-bordered tablesorter"><thead><tr><th>序号<th>线号<th>协议<th>端口<th>用户编号<th>型号<th>序列号<th>IP<th>上线时间<tbody id=session-list></table></div></div></div></div></section></div></div><div id=spinner class=spinner style=display:none>Loading&hellip;</div>{{> footer}}<script src=../js/jquery/jquery-tablesorter.js></script><script src=../js/jquery/jquery-chosen.js></script><script>$(document).ready(function(){function e(){$("#sys-uptime").html(o["sys-uptime"]).css("color","green"),$("#sys-time").html(o["sys-time"]).css("color","green"),$("#sys-model").html(o["sys-model"]).css("color","green"),$("#sys-sn").html(o["sys-sn"]).css("color","green"),$("#sys-version").html(o["sys-version"]).css("color","green"),$("#sys-os").html(o["sys-os"]).css("color","green"),o["sys-serial-fail"]?$("#sys-serial").html("故障").css("color","red"):$("#sys-serial").html("正常").css("color","green"),o["sys-network-fail"]?$("#sys-network").html("故障").css("color","red"):$("#sys-network").html("正常").css("color","green"),$("#total-online").html(o["total-online"]).css("color","green");var e=$("#session-list");e.empty();for(var s=0;s<o.sessions.length;s++){var n=o.sessions[s],t=$("<tr>").attr("id",s);t.append($("<td>").append(n.order)),t.append($("<td>").append(n.line)),t.append($("<td>").append(n.protocol)),t.append($("<td>").append(n.port)),t.append($("<td>").append(n.acct)),t.append($("<td>").append(n.model)),t.append($("<td>").append(n.sn)),t.append($("<td>").append(n.ip)),t.append($("<td>").append(n.uptime)),t.appendTo(e)}}function s(){$.getJSON("/api/get-server-status").error(function(e){location.reload()}).done(function(s){o=s,e(),n(),p=5})}function n(){$("#update-counter").text(p),p--,0===p?s():setTimeout(n,1e3)}function t(e,s){var n=$("#lines-list"),t=$("<tr>").attr("id","row-"+e);s.enabled?$("<td>").appendTo(t).append("已启用").css("color","green"):$("<td>").appendTo(t).append("未启用").css("color","red"),$("<td>").attr("id","col-key").addClass("center").append(e).appendTo(t),$("<td>").appendTo(t).append(s.name),$("<td>").appendTo(t).append(s.prefix),$("<td>").appendTo(t).append(s.port),$("<td>").appendTo(t).append(s.protocol),t.appendTo(n)}$("#session-list").tablesorter(),$(".chosen").chosen();var o={},p=5;s(),settings={},$.getJSON("/api/get-lines",function(e){settings=e;var s=$("#lines-list");s.empty();for(var n in settings)if(settings.hasOwnProperty(n)){var o=settings[n];t(n,o)}})})</script>