<!DOCTYPE html><html lang=zh-CN>{{> header}}{{> page_header}}<div id=body-container><div id=body-content>{{> nav}}<section class="page container"><form class=form-horizontal><div class=container><div class=row><div id=net-settings-row class=span7><fieldset><legend>网络全局参数设置</legend><br><div class=control-group><label class=control-label>默认网卡(双网卡时设置)</label><div class=controls><select id=net-route-default-gateway-dev name=net-route-default-gateway-dev class=span2><option value=eth0>网卡1<option value=eth1>网卡2</select></div></div><div class=control-group><label class=control-label>默认网关(双网卡时设置)<br>(需重启)</label><div class=controls><input id=net-route-default-gateway name=net-route-default-gateway class=span4 autocomplete=false></div></div><div class=control-group><label class=control-label>域名服务器</label><div class=controls><input id=net-nameserver name=net-nameserver class=span4 autocomplete=false></div></div></fieldset></div></div><div class=row><div id=eth0-settings-row class=span7><fieldset><legend>网卡1设置</legend><br><div class=control-group><label class=control-label>已启用</label><div class=controls><select id=net-eth0-active name=net-eth0-active class=span2 value=false disabled><option value=false>停用<option value=true>启用</select></div></div><div class=control-group><label class=control-label>IP地址获取方式</label><div class=controls><select id=net-eth0-mode class=span2><option value=dhcp>自动获取<option value=static>手动设置</select></div></div><div class=control-group><label class=control-label>IP地址</label><div class=controls><input id=net-eth0-ip class=span4 autocomplete=false></div></div><div class=control-group><label class=control-label>网络掩码</label><div class=controls><input id=net-eth0-mask class=span4 autocomplete=false></div></div><div class=control-group><label class=control-label>网关</label><div class=controls><input id=net-eth0-gateway class=span4 autocomplete=false></div></div></fieldset></div><div id=stat-eth0 class=span7><fieldset><legend>网卡1当前状态</legend><br><div class=control-group><label class=control-label>是否已启用</label><div class=controls><input id=stat-eth0-active class=span4 autocomplete=false readonly></div></div><div class=control-group><label class=control-label>网线已连接</label><div class=controls><input id=stat-eth0-running class=span4 autocomplete=false readonly></div></div><div class=control-group><label class=control-label>IP地址获取方式</label><div class=controls><input id=stat-eth0-mode class=span4 autocomplete=false readonly></div></div><div class=control-group><label class=control-label>IP地址</label><div class=controls><input id=stat-eth0-ip name=net-eth0-ip class=span4 autocomplete=false readonly></div></div><div class=control-group><label class=control-label>网络掩码</label><div class=controls><input id=stat-eth0-mask name=net-eth0-mask class=span4 autocomplete=false readonly></div></div><div class=control-group><label class=control-label>网关</label><div class=controls><input id=stat-eth0-gateway class=span4 autocomplete=false readonly></div></div><div class=control-group><label class=control-label>MAC地址</label><div class=controls><input id=stat-eth0-mac name=net-eth0-mac class=span4 autocomplete=false readonly></div></div><div class=control-group><label class=control-label>已接收数据</label><div class=controls><input id=stat-eth0-rx name=net-eth0-rx class=span2 autocomplete=false readonly></div></div><div class=control-group><label class=control-label>已发送数据</label><div class=controls><input id=stat-eth0-tx name=net-eth0-tx class=span2 autocomplete=false readonly></div></div></fieldset></div></div><div class=row><div id=eth1-settings-row class=span7><fieldset><legend>网卡2设置</legend><br><div class=control-group><label class=control-label>已启用</label><div class=controls><select id=net-eth1-active name=net-eth1-active class=span2 value=false><option value=false>停用<option value=true>启用</select></div></div><div class=control-group><label class=control-label>IP地址获取方式</label><div class=controls><select id=net-eth1-mode class=span2><option value=dhcp>自动获取<option value=static>手动设置</select></div></div><div class=control-group><label class=control-label>IP地址</label><div class=controls><input id=net-eth1-ip class=span4 autocomplete=false></div></div><div class=control-group><label class=control-label>网络掩码</label><div class=controls><input id=net-eth1-mask class=span4 autocomplete=false></div></div><div class=control-group><label class=control-label>网关</label><div class=controls><input id=net-eth1-gateway class=span4 autocomplete=false></div></div></fieldset></div><div id=stat-eth1 class=span7><fieldset><legend>网卡2当前状态</legend><br><div class=control-group><label class=control-label>是否已启用</label><div class=controls><input id=stat-eth1-active class=span4 autocomplete=false readonly></div></div><div class=control-group><label class=control-label>网线已连接</label><div class=controls><input id=stat-eth1-running class=span4 autocomplete=false readonly></div></div><div class=control-group><label class=control-label>IP地址获取方式</label><div class=controls><input id=stat-eth1-mode class=span4 autocomplete=false readonly></div></div><div class=control-group><label class=control-label>IP地址</label><div class=controls><input id=stat-eth1-ip name=net-eth1-ip class=span4 autocomplete=false readonly></div></div><div class=control-group><label class=control-label>网络掩码</label><div class=controls><input id=stat-eth1-mask name=net-eth1-mask class=span4 autocomplete=false readonly></div></div><div class=control-group><label class=control-label>网关</label><div class=controls><input id=stat-eth1-gateway class=span4 autocomplete=false readonly></div></div><div class=control-group><label class=control-label>MAC地址</label><div class=controls><input id=stat-eth1-mac name=net-eth1-mac class=span4 autocomplete=false readonly></div></div><div class=control-group><label class=control-label>已接收数据</label><div class=controls><input id=stat-eth1-rx name=net-eth1-rx class=span2 autocomplete=false readonly></div></div><div class=control-group><label class=control-label>已发送数据</label><div class=controls><input id=stat-eth1-tx name=net-eth1-tx class=span2 autocomplete=false readonly></div></div></fieldset></div></div></div></form></section></div></div><footer class=application-footer><div class=container><p><img src=images/conwin.png><div class=disclaimer><p>All right reserved.<p>Copyright © conwin 1993-2015</div></div></footer><script>$(function(){function t(t){var t=t||window.event;return t&&(t.returnValue="数据已修改"),"数据已修改"}function e(){window.onbeforeunload=t}function a(t,a){e(),r[a]||(r[a]={}),"static"===t?($("#net-"+a+"-ip").val(r[a].ip).attr("readonly",!1).attr("disabled",null),$("#net-"+a+"-mask").val(r[a].mask).attr("readonly",!1).attr("disabled",null),$("#net-"+a+"-gateway").val(r[a].gw).attr("readonly",!1).attr("disabled",null)):"dhcp"===t&&(r[a].ip=$("#net-"+a+"-ip").val(),r[a].mask=$("#net-"+a+"-mask").val(),r[a].gw=$("#net-"+a+"-gateway").val(),$("#net-"+a+"-ip").val("自动获取").attr("readonly",!0).attr("disabled",null),$("#net-"+a+"-mask").val("自动获取").attr("readonly",!0).attr("disabled",null),$("#net-"+a+"-gateway").val("自动获取").attr("readonly",!0).attr("disabled",null))}function n(){for(var t=0,e=0;2>e;e++){var a,n="#net-eth"+e+"-",l=$(n+"active").attr("value");if("true"===l){t++;var r=$(n+"mode").attr("value");a="dhcp"===r?"true":null,$(n+"mode").attr("disabled",null)}else a="true",$(n+"mode").attr("disabled","true");["ip","mask","gateway"].forEach(function(t){$(n+t).attr("disabled",a)})}1===t?($("#net-route-default-gateway-dev").attr("disabled","true"),$("#net-route-default-gateway").attr("disabled","true")):($("#net-route-default-gateway-dev").attr("disabled",null),$("#net-route-default-gateway").attr("disabled",null))}function l(){$.getJSON("/api/box-net-stat").done(function(t){var e={dhcp:"自动获取","static":"手动设置"};$("#stat-eth0-mode").val(e[t.mode]);var a,n;for(a in t)t.hasOwnProperty(a)&&(n=t[a],"boolean"==typeof n&&(n=n?"是":"否"),$("#"+a).val(n));setTimeout(l,5e3)}).fail(function(t,e,a){setTimeout(l,5e3)})}var r={};$("#net-eth0-mode").change(function(){var t=$(this).val();a(t,"eth0")}),$("#net-eth1-mode").change(function(){var t=$(this).val();a(t,"eth1")}),$("#submit-confirm-button").click(function(){var t={};t["net-route-default-gateway"]=$("#net-route-default-gateway").val(),t["net-route-default-gateway-dev"]=$("#net-route-default-gateway-dev").val(),t["net-eth0-active"]=$("#net-eth0-active").val(),t["net-eth0-mode"]=$("#net-eth0-mode").val(),"static"==t["net-eth0-mode"]?(t["net-eth0-gateway"]=$("#net-eth0-gateway").val(),t["net-eth0-ip"]=$("#net-eth0-ip").val(),t["net-eth0-mask"]=$("#net-eth0-mask").val()):(t["net-eth0-gateway"]=r.eth0.gw,t["net-eth0-ip"]=r.eth0.ip,t["net-eth0-mask"]=r.eth0.mask),t["net-eth1-active"]=$("#net-eth1-active").val(),t["net-eth1-mode"]=$("#net-eth1-mode").val(),"static"==t["net-eth1-mode"]?(t["net-eth1-gateway"]=$("#net-eth1-gateway").val(),t["net-eth1-ip"]=$("#net-eth1-ip").val(),t["net-eth1-mask"]=$("#net-eth1-mask").val()):(t["net-eth1-gateway"]=r.eth1.gw,t["net-eth1-ip"]=r.eth1.ip,t["net-eth1-mask"]=r.eth1.mask),t["net-nameserver"]=$("#net-nameserver").val();var e=[];if(e.length>0)return alert("数据错误 : \n"+e.join("\n")),!1;var a=JSON.stringify(t);return confirm("确认保存?")?($.getJSON("/api/box-net-set?data="+a).done(function(t){return"OK"!=t.result?(alert("配置保存失败:"+JSON.stringify(t)),!1):(alert("配置保存成功."),void(window.onbeforeunload=null))}).fail(function(t,e,a){alert("数据保存失败, 请重新保存.")}),!0):!1}),$.getJSON("/api/box-net-get",function(t){1===t["net-if-cnt"]&&($("#net-eth1-active").html("<option value=false>未安装</option"),$("#net-eth1-active").attr("disabled",!0),$("#net-eth1-dhcp").attr("disabled",!0));var e,a=0;for(e in t)if(t.hasOwnProperty(e)){var l=t[e];$("#"+e).attr("value",l)}r={eth0:{},eth1:{}},r.eth0.gw=t["net-eth0-gateway"],r.eth0.ip=t["net-eth0-ip"],r.eth0.mask=t["net-eth0-mask"],r.eth1.gw=t["net-eth1-gateway"],r.eth1.ip=t["net-eth1-ip"],r.eth1.mask=t["net-eth1-mask"],1===a&&$("#net-eth0-gateway").attr("value",t["net-route-default-gateway"]),$("#net-eth0-dhcp").on("change",n),$("#net-eth1-dhcp").on("change",n),$("#net-eth0-active").on("change",n),$("#net-eth1-active").on("change",n),n()}),l()})</script>