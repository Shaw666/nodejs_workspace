<!DOCTYPE html><html lang=en>{{> header}}{{> page_header}}<div id=body-container><div id=body-content>{{> nav}}<section class="page container"><form class=form-horizontal><div class=container><div class=row><div id=server-settings-row class=span7><fieldset><legend>接警机参数</legend><br><div class=control-group><label class=control-label>接警机编号</label><div class=controls><input id=reciver-number type=number class=span4 autocomplete=false></div></div><div class=control-group><label class=control-label>串口通信速率<br>(修改后需要重新登录)</label><div class=controls><select id=serial-baud class=span2><option value=9600>9600<option value=19200>19200<option value=38400>38400<option value=57600>57600<option value=115200>115200</select></div></div><div class=control-group><label class=control-label>串口通信协议</label><div class=controls><select id=serial-format class=span2><option value=conwin>丛文扩展协议<option value=685>标准685协议</select></div></div><div class=control-group><label class=control-label>优先上传主机事件</label><div class=controls><input id=panel-event-first type=checkbox class="switch span4"></div></div><div class=control-group><label class=control-label>记录上线/掉线事件</label><div class=controls><input id=log-online-offline type=checkbox class="switch span4"></div></div><div class=control-group><label class=control-label>模块上线/掉线时报告事件</label><div class=controls><input id=report-online-offline name=server-allow-api-timesync type=checkbox class="switch span4"></div></div><div class=control-group><label class=control-label>脱网认定时间(秒)</label><div class=controls><input id=confirm-offline-time type=number class=span4 autocomplete=false></div></div><div class=control-group><label class=control-label>允许向设备发送控制命令</label><div class=controls><input id=allow-control-device type=checkbox class="switch span4"></div></div></fieldset></div><div id=api-settings-row class=span7><fieldset><legend>系统参数设置</legend><br><div class=control-group><label class=control-label>API访问密码</label><div class=controls><input id=api-key class=span4 autocomplete=false></div></div><div class=control-group><label class=control-label>系统时间</label><div class=controls><input id=system-time class=span4 placeholder="2016-5-17 13:33:34" autocomplete=false></div></div><div class=control-group><label class=control-label>允许通过API设置时间</label><div class=controls><input id=api-allow-set-time type=checkbox class="switch span4"></div></div><div class=control-group><label class=control-label>允许通过API重启</label><div class=controls><input id=api-allow-reboot type=checkbox class="switch span4"></div></div></fieldset></div><div id=server-settings-row class=span7><fieldset><legend>网络端口</legend><br><div class=control-group><label class=control-label>管理界面端口<br>(修改后需要重新登录)</label><div class=controls><input id=web-port type=number class=span4 autocomplete=false></div></div></fieldset></div></div></div></form></section></div></div>{{> footer}}<script src=../js/bootstrap/bootstrap-switch.js></script><script>$(function(){function t(){window.onbeforeunload=e}function e(t){var t=t||window.event;return t&&(t.returnValue="数据已修改"),"数据已修改"}Date.prototype.format=function(t){t||(t="yyyy-MM-dd hh:mm:ss");var e={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in e)new RegExp("("+n+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?e[n]:("00"+e[n]).substr((""+e[n]).length)));return t},$.fn.bootstrapSwitch.defaults.size="small",$(".switch").bootstrapSwitch();var n;$("#submit-confirm-button").click(function(){var t;for(t in n)if(n.hasOwnProperty(t)){var e=n[t],r=$("#"+t);"boolean"==typeof e&&void 0!==e?n[t]=r.bootstrapSwitch("state"):"number"==typeof e?n[t]=parseInt(r.val(),10):n[t]=r.val()}if(confirm("确认保存?")){var o=JSON.stringify(n);return $.getJSON("/api/set-ipr?data="+o).done(function(t){return"OK"!=t.result?(alert("配置保存失败:"+JSON.stringify(t)),!1):(window.onbeforeunload=null,void alert("配置保存成功."))}).fail(function(t,e,n){alert("数据保存失败, 请重新保存.",n)}),!0}}),$.getJSON("/api/get-ipr-settings",function(e){$("#system-time").attr("placeholder",(new Date).format()),n=e;var r;for(r in n)if(n.hasOwnProperty(r)){var o=n[r],i=$("#"+r);"boolean"==typeof o&&o?i.bootstrapSwitch("state",!0,!0):i.val(o),i.change(t)}})})</script>